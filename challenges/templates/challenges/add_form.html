{% extends "base.html" %}

{% block container %}
{% load static %}



  <!-- Page Heading -->
  <div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Inicia una nueva Rifa</h1>
  </div>


<div class="row">
  <div class="col-lg-9 mb-9">
    

    <form method="POST" action="{{ form_action }}">
        {% csrf_token %}

      <div class="form-group">
        <label for="{{ form.title.id_for_label }}">Titulo de tu rifa</label>
        {{ form.title }}
        {{ form.title.errors }}
      </div>
      <div class="form-group">

        <label for="{{ form.category.id_for_label }}">Categoria</label>
        {{ form.category }}
        {{ form.category.errors }}

    </div>
     
      <div class="form-group">
        <label for="{{ form.description.id_for_label }}">Descripción del premio</label>
        {{ form.description }}
        {{ form.description.errors }}
    </div>


      <div class="form-group">
        <p>Fija un precio por tiquete</p>
        <label class="sr-only" for="{{ form.price.id_for_label }}">Precio tiquete</label>
        <div class="input-group mb-2">
          <div class="input-group-prepend">
            <div class="input-group-text">$</div>
          </div>
          {{ form.price }}
        </div>
        {{ form.price.errors }}

      </div>


      <div class="form-group">
        <p>Fija la fecha del sorteo</p>
        <label class="sr-only" for="{{ form.end_date.id_for_label }}">Fecha</label>
        <div class="input-group mb-2">
          <div class="input-group-prepend">
            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
          </div>
          {{form.end_date }}
        </div>
        {{ form.end_date.errors }}
    </div>

      <div class="form-group">
        <p>Ingresa un telefono de contacto</p>
        <label class="sr-only" for="{{ form.phone.id_for_label }}">Telefono</label>
        <div class="input-group mb-2">
          <div class="input-group-prepend">
            <div class="input-group-text"><i class="fa fa-phone"></i></div>
          </div>
          {{ form.phone }}
        </div>
        {{ form.phone.errors }}
      </div>

      <div class="card">
        <div class="card-body" style="padding: 0px;">
            <div id="dropzon" style="padding: 20px; cursor:pointer">
                Sube algunas fotos, da clic aquí en esta área
            </div>

        </div>
      </div>
      <div id="path_imgs"></div>
      <input type="submit" value=" GUARDAR " style="margin-top: 20px;" class="btn btn-primary" />
      <br /><br />
    </form>
    

</div>
</div>

{% endblock container %}

{% block scripts %}
<link href="{% static 'css/dropzone.css' %}" rel="stylesheet" type="text/css">
<script src="{% static 'js/dropzone.js' %}"></script>
<style type="text/css">
.dz-error-mark, .dz-success-mark {
    display: none;
}
.dz-preview {
    float: left;
    padding-right: 18px;
}
</style>
<script type="text/javascript">
    jQuery("div#dropzon").dropzone({
        paramName: "image",
        url: "{% url 'rifa:upload_img' %}" , 
        maxFilesize: 2,
        headers: {"X-CSRFToken": "{{ csrf_token }}"},
        maxFiles: 3,
        success: function(file, response) {
           if (response.success) {
               jQuery("#path_imgs").html(jQuery("#path_imgs").html() + "<input type='hidden' name='images[]' value='" + response.path + "'/>")
           } else {
               alert("Ocurrio un error al subir tu imagen, intenta mas tarde")
           }
    }});
    jQuery( "input[name='end_date']" ).datepicker({dateFormat: 'yy-mm-dd'});
</script>

{% endblock scripts %}